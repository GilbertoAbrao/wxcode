---
phase: 14-data-models
plan: 02
type: execute
wave: 2
depends_on: ["14-01"]
files_modified:
  - src/wxcode/models/__init__.py
  - src/wxcode/database.py
autonomous: true

must_haves:
  truths:
    - "All three models exportable from wxcode.models"
    - "All three models registered with Beanie init_db"
    - "Models can be instantiated after database connection"
  artifacts:
    - path: "src/wxcode/models/__init__.py"
      provides: "Model exports"
      contains: "Stack"
    - path: "src/wxcode/database.py"
      provides: "Beanie registration"
      contains: "Stack"
  key_links:
    - from: "src/wxcode/models/__init__.py"
      to: "src/wxcode/models/stack.py"
      via: "import statement"
      pattern: "from wxcode.models.stack import Stack"
    - from: "src/wxcode/database.py"
      to: "src/wxcode/models"
      via: "document_models list"
      pattern: "Stack.*OutputProject.*Milestone"
---

<objective>
Wire the new models into the system by exporting from __init__.py and registering with Beanie.

Purpose: Without proper exports and registration, the models cannot be used by other parts of the application. This plan completes the wiring that makes the models usable.

Output: Updated __init__.py with exports, updated database.py with Beanie registration.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/STATE.md
@.planning/phases/14-data-models/14-01-SUMMARY.md

# Files to modify
@src/wxcode/models/__init__.py
@src/wxcode/database.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Export Models from __init__.py</name>
  <files>src/wxcode/models/__init__.py</files>
  <action>
Add imports and exports for the three new models to src/wxcode/models/__init__.py.

Add imports at appropriate location (after existing imports):
```python
from wxcode.models.stack import Stack
from wxcode.models.output_project import OutputProject, OutputProjectStatus
from wxcode.models.milestone import Milestone, MilestoneStatus
```

Add to __all__ list (create new section for v4 models):
```python
# v4 Models
"Stack",
"OutputProject",
"OutputProjectStatus",
"Milestone",
"MilestoneStatus",
```

Keep existing imports and exports intact. Add new ones at the end before the closing bracket of __all__.
  </action>
  <verify>
python -c "from wxcode.models import Stack, OutputProject, OutputProjectStatus, Milestone, MilestoneStatus; print('All exports working')"
  </verify>
  <done>
All three models and their enums are exported from wxcode.models.
  </done>
</task>

<task type="auto">
  <name>Task 2: Register Models with Beanie</name>
  <files>src/wxcode/database.py</files>
  <action>
Add the three new models to Beanie's init_beanie document_models list.

Add imports at top (after existing model imports):
```python
from wxcode.models import (
    # ... existing imports ...
    Stack,
    OutputProject,
    Milestone,
)
```

Or import directly from the new files to match existing pattern:
```python
from wxcode.models.stack import Stack
from wxcode.models.output_project import OutputProject
from wxcode.models.milestone import Milestone
```

Add to document_models list in init_beanie call:
```python
document_models=[
    # ... existing models ...
    Stack,
    OutputProject,
    Milestone,
]
```

The order in the list doesn't matter for Beanie, but keep it organized (add at end).
  </action>
  <verify>
python -c "
import asyncio
from wxcode.database import init_db

async def test():
    await init_db()
    from wxcode.models import Stack, OutputProject, Milestone
    # If we get here without error, registration worked
    print('Beanie registration successful')

asyncio.run(test())
"
  </verify>
  <done>
All three models registered with Beanie and collections will be created on first use.
  </done>
</task>

</tasks>

<verification>
Full integration test:
```bash
python -c "
import asyncio
from wxcode.database import init_db
from wxcode.models import Stack, OutputProject, OutputProjectStatus, Milestone, MilestoneStatus

async def test():
    await init_db()

    # Check models are properly registered
    print('Stack collection:', Stack.get_settings().name)
    print('OutputProject collection:', OutputProject.get_settings().name)
    print('Milestone collection:', Milestone.get_settings().name)

    # Check enums
    print('OutputProjectStatus values:', [s.value for s in OutputProjectStatus])
    print('MilestoneStatus values:', [s.value for s in MilestoneStatus])

    print('All models properly wired!')

asyncio.run(test())
"
```
</verification>

<success_criteria>
- Stack, OutputProject, Milestone importable from wxcode.models
- OutputProjectStatus, MilestoneStatus importable from wxcode.models
- All three models in Beanie document_models list
- init_db() completes without errors
- Collections created: stacks, output_projects, milestones
</success_criteria>

<output>
After completion, create `.planning/phases/14-data-models/14-02-SUMMARY.md`
</output>
