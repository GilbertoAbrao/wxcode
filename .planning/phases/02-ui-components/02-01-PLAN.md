---
phase: 02-ui-components
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/package.json
  - frontend/package-lock.json
  - frontend/src/types/project.ts
  - frontend/src/hooks/useDeleteProject.ts
  - frontend/src/hooks/index.ts
autonomous: true

must_haves:
  truths:
    - "Radix AlertDialog package is installed and available for import"
    - "DeleteProjectResponse type matches backend API response structure"
    - "useDeleteProject hook returns mutation with isPending, error, and mutate"
    - "Calling mutate triggers DELETE request and invalidates projects cache"
  artifacts:
    - path: "frontend/src/types/project.ts"
      provides: "DeleteProjectResponse interface"
      contains: "interface DeleteProjectResponse"
    - path: "frontend/src/hooks/useDeleteProject.ts"
      provides: "Delete project mutation hook"
      exports: ["useDeleteProject"]
  key_links:
    - from: "frontend/src/hooks/useDeleteProject.ts"
      to: "/api/projects/{projectId}"
      via: "fetch DELETE request"
      pattern: "fetch.*DELETE"
    - from: "frontend/src/hooks/useDeleteProject.ts"
      to: "@tanstack/react-query"
      via: "useMutation hook"
      pattern: "useMutation"
---

<objective>
Install Radix AlertDialog and create the useDeleteProject hook with types

Purpose: Establish the foundation for the delete confirmation modal - the package, types, and data fetching hook that the modal component will use.

Output: Radix AlertDialog installed, DeleteProjectResponse type defined, useDeleteProject hook ready for use in modal.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-ui-components/02-RESEARCH.md

# Prior phase context
@.planning/phases/01-backend-safety/01-01-SUMMARY.md

# Existing patterns to follow
@frontend/src/hooks/useConversions.ts
@frontend/src/types/project.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install Radix AlertDialog package</name>
  <files>frontend/package.json, frontend/package-lock.json</files>
  <action>
    Run: `cd frontend && npm install @radix-ui/react-alert-dialog`

    This installs the Radix AlertDialog primitive which provides:
    - WAI-ARIA compliant modal
    - Built-in focus trap
    - Escape key handling
    - Portal rendering

    Verify installation completed successfully and package appears in dependencies.
  </action>
  <verify>
    Run: `cat frontend/package.json | grep "react-alert-dialog"`
    Expected: `"@radix-ui/react-alert-dialog": "^1.x.x"`
  </verify>
  <done>@radix-ui/react-alert-dialog appears in frontend/package.json dependencies</done>
</task>

<task type="auto">
  <name>Task 2: Add DeleteProjectResponse type</name>
  <files>frontend/src/types/project.ts</files>
  <action>
    Add the DeleteProjectResponse interface to project.ts that matches the backend API response.

    The backend returns (from src/wxcode/api/projects.py):
    ```python
    class DeleteProjectResponse(BaseModel):
        message: str
        stats: dict[str, int]
    ```

    And stats contains (from PurgeStats.to_dict()):
    - project_name: string
    - projects, elements, controls, procedures, class_definitions, schemas, conversions: number
    - total: number
    - files_deleted, directories_deleted, total_files: number
    - neo4j_nodes?: number (optional)
    - neo4j_error?: string (optional)
    - files_error?: string (optional)

    Add this interface at the end of the file, before the config objects:

    ```typescript
    // Delete project types
    export interface DeleteProjectStats {
      project_name: string;
      projects: number;
      elements: number;
      controls: number;
      procedures: number;
      class_definitions: number;
      schemas: number;
      conversions: number;
      total: number;
      files_deleted: number;
      directories_deleted: number;
      total_files: number;
      neo4j_nodes?: number;
      neo4j_error?: string;
      files_error?: string;
    }

    export interface DeleteProjectResponse {
      message: string;
      stats: DeleteProjectStats;
    }
    ```
  </action>
  <verify>
    Run: `grep -A 5 "interface DeleteProjectResponse" frontend/src/types/project.ts`
    Expected: Shows the interface definition
  </verify>
  <done>DeleteProjectResponse and DeleteProjectStats interfaces exist in project.ts with all required fields</done>
</task>

<task type="auto">
  <name>Task 3: Create useDeleteProject hook</name>
  <files>frontend/src/hooks/useDeleteProject.ts, frontend/src/hooks/index.ts</files>
  <action>
    Create frontend/src/hooks/useDeleteProject.ts following the useCreateConversion pattern.

    The hook should:
    1. Use TanStack Query's useMutation
    2. Call DELETE /api/projects/{projectId}
    3. On success, invalidate the ["projects"] query
    4. Return the mutation object with isPending, error, mutate, etc.

    Implementation:

    ```typescript
    "use client";

    /**
     * Hook para deletar um projeto.
     * Invalida a lista de projetos após exclusão bem-sucedida.
     */

    import { useMutation, useQueryClient } from "@tanstack/react-query";
    import type { DeleteProjectResponse } from "@/types/project";

    async function deleteProject(projectId: string): Promise<DeleteProjectResponse> {
      const response = await fetch(`/api/projects/${projectId}`, {
        method: "DELETE",
      });

      if (!response.ok) {
        const error = await response.json();
        throw new Error(error.detail || "Falha ao excluir projeto");
      }

      return response.json();
    }

    export function useDeleteProject() {
      const queryClient = useQueryClient();

      return useMutation({
        mutationFn: deleteProject,
        onSuccess: () => {
          // Invalidate projects list to refresh after deletion
          queryClient.invalidateQueries({ queryKey: ["projects"] });
        },
      });
    }
    ```

    Then update frontend/src/hooks/index.ts to export the new hook:
    - Add: `export { useDeleteProject } from "./useDeleteProject";`
  </action>
  <verify>
    Run: `head -20 frontend/src/hooks/useDeleteProject.ts && grep "useDeleteProject" frontend/src/hooks/index.ts`
    Expected: Shows hook implementation and export line
  </verify>
  <done>useDeleteProject hook exists, exports correctly, uses useMutation with DELETE request and cache invalidation</done>
</task>

</tasks>

<verification>
After all tasks complete:

1. Package installed: `npm ls @radix-ui/react-alert-dialog` in frontend directory shows version
2. Types compile: `cd frontend && npx tsc --noEmit` passes (or check specific file)
3. Hook exports: `grep -r "useDeleteProject" frontend/src/hooks/` shows implementation and export
</verification>

<success_criteria>
- Radix AlertDialog package installed in frontend
- DeleteProjectResponse type matches backend API structure
- useDeleteProject hook implemented following useCreateConversion pattern
- Hook exported from hooks/index.ts
- No TypeScript compilation errors in modified files
</success_criteria>

<output>
After completion, create `.planning/phases/02-ui-components/02-01-SUMMARY.md`
</output>
