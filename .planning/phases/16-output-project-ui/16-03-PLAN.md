---
phase: 16-output-project-ui
plan: 03
type: execute
wave: 3
depends_on: ["16-02"]
files_modified:
  - frontend/src/components/output-project/StackSelector.tsx
  - frontend/src/components/output-project/ConfigurationSelector.tsx
  - frontend/src/components/output-project/CreateProjectModal.tsx
  - frontend/src/components/output-project/index.ts
autonomous: true

must_haves:
  truths:
    - "User can see stacks grouped by category in StackSelector"
    - "User can select a single stack with visual feedback"
    - "User can select a configuration from KB dropdown"
    - "User can open CreateProjectModal and complete the flow"
    - "CreateProjectModal creates output project via mutation"
  artifacts:
    - path: "frontend/src/components/output-project/StackSelector.tsx"
      provides: "Grouped radio button selection for stacks"
      min_lines: 80
    - path: "frontend/src/components/output-project/ConfigurationSelector.tsx"
      provides: "Dropdown selection for KB configurations"
      min_lines: 40
    - path: "frontend/src/components/output-project/CreateProjectModal.tsx"
      provides: "Modal combining stack and config selection"
      min_lines: 120
    - path: "frontend/src/components/output-project/index.ts"
      provides: "Component exports"
      exports: ["StackSelector", "ConfigurationSelector", "CreateProjectModal"]
  key_links:
    - from: "frontend/src/components/output-project/CreateProjectModal.tsx"
      to: "useCreateOutputProject"
      via: "mutation hook"
      pattern: "useCreateOutputProject"
    - from: "frontend/src/components/output-project/CreateProjectModal.tsx"
      to: "useStacksGrouped"
      via: "query hook"
      pattern: "useStacksGrouped"
    - from: "frontend/src/components/output-project/StackSelector.tsx"
      to: "StacksGroupedResponse"
      via: "type import"
      pattern: "import.*StacksGroupedResponse"
---

<objective>
Create React components for the output project creation flow: stack selection, configuration selection, and the combined modal.

Purpose: Provide the user interface for selecting a target stack and optional configuration when creating a new output project from a Knowledge Base.

Output: Three components that work together to enable the complete creation flow, ready for integration into KB detail page.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/16-output-project-ui/16-RESEARCH.md
@.planning/phases/16-output-project-ui/16-02-SUMMARY.md

# Existing patterns
@frontend/src/components/project/DeleteProjectModal.tsx
@frontend/src/components/product/ProductCard.tsx
@frontend/src/lib/utils.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create StackSelector component</name>
  <files>frontend/src/components/output-project/StackSelector.tsx</files>
  <action>
Create a grouped radio button selection component for stacks.

File: frontend/src/components/output-project/StackSelector.tsx

Features:
1. Display stacks grouped by category (Server-rendered, SPA, Fullstack)
2. Radio button selection with visual feedback (border highlight, inner dot)
3. Show stack details (language / ORM) next to name
4. Loading skeleton state
5. Scrollable container for many options

Props interface:
```typescript
interface StackSelectorProps {
  stacks: StacksGroupedResponse;
  selectedStackId: string | null;
  onSelect: (stackId: string) => void;
  isLoading?: boolean;
}
```

Use cn() utility for conditional classnames.
Use existing Tailwind patterns from DeleteProjectModal:
- border-zinc-800 for default borders
- border-blue-500 for selected state
- bg-blue-500/10 for selected background
- text-zinc-100 for primary text
- text-zinc-400/500 for secondary text

Create internal StackOption component for individual radio items.

Group labels constant: { server_rendered: "Server-rendered", spa: "SPA", fullstack: "Fullstack" }

Loading skeleton: 3 groups with 2-3 pulsing items each.
  </action>
  <verify>
```bash
cd /Users/gilberto/projetos/wxk/wxcode/frontend
npx tsc --noEmit src/components/output-project/StackSelector.tsx 2>&1 | head -20 || echo "Type check done"
```
  </verify>
  <done>
- StackSelector.tsx exists with proper TypeScript types
- Displays 3 groups with category headers
- Radio selection works with visual feedback
- Loading state shows skeleton
  </done>
</task>

<task type="auto">
  <name>Task 2: Create ConfigurationSelector component</name>
  <files>frontend/src/components/output-project/ConfigurationSelector.tsx</files>
  <action>
Create a dropdown select component for KB configurations.

File: frontend/src/components/output-project/ConfigurationSelector.tsx

Features:
1. Native select dropdown (simple, accessible)
2. Optional - can be null/empty
3. Display configuration name
4. Disabled state while loading

Props interface:
```typescript
interface ConfigurationSelectorProps {
  configurations: Configuration[];
  selectedId: string | null;
  onSelect: (configId: string | null) => void;
  disabled?: boolean;
}
```

Use Configuration type from types/output-project.ts.

Styling:
- Match existing input styles (bg-zinc-800, border-zinc-700)
- Focus state with blue ring
- Disabled state with opacity

Include "None (all elements)" option at top for null selection.
  </action>
  <verify>
```bash
cd /Users/gilberto/projetos/wxk/wxcode/frontend
npx tsc --noEmit src/components/output-project/ConfigurationSelector.tsx 2>&1 | head -20 || echo "Type check done"
```
  </verify>
  <done>
- ConfigurationSelector.tsx exists with proper TypeScript types
- Native select with "None" option
- Calls onSelect with configId or null
  </done>
</task>

<task type="auto">
  <name>Task 3: Create CreateProjectModal and index exports</name>
  <files>frontend/src/components/output-project/CreateProjectModal.tsx, frontend/src/components/output-project/index.ts</files>
  <action>
Create the main modal that combines stack and configuration selection.

File: frontend/src/components/output-project/CreateProjectModal.tsx

Features:
1. Radix Dialog (not AlertDialog - this is a form, not confirmation)
2. Multi-step flow in single modal:
   - Project name input
   - Stack selection (required)
   - Configuration selection (optional)
3. Create button disabled until name and stack selected
4. Loading state during mutation
5. Error display
6. Close on success

Props interface:
```typescript
interface CreateProjectModalProps {
  kbId: string;
  kbName: string;
  configurations: Configuration[];
  isOpen: boolean;
  onClose: () => void;
  onCreated?: (project: OutputProject) => void;
}
```

Use hooks:
- useStacksGrouped() for fetching stacks
- useCreateOutputProject() for mutation

State:
- name: string
- selectedStackId: string | null
- selectedConfigId: string | null

Form flow:
1. Name input at top
2. StackSelector below (scrollable)
3. ConfigurationSelector below stack
4. Actions: Cancel, Create Project

Modal styling (from DeleteProjectModal pattern):
- Fixed positioning with z-50
- bg-zinc-900 border border-zinc-800 rounded-lg
- Max width max-w-2xl (wider for stack selector)
- Padding p-6

Include @radix-ui/react-dialog import. Note: This package may need to be installed.

File: frontend/src/components/output-project/index.ts
```typescript
export { StackSelector } from "./StackSelector";
export { ConfigurationSelector } from "./ConfigurationSelector";
export { CreateProjectModal } from "./CreateProjectModal";
```
  </action>
  <verify>
```bash
cd /Users/gilberto/projetos/wxk/wxcode/frontend

# Install radix dialog if needed
npm list @radix-ui/react-dialog 2>/dev/null || npm install @radix-ui/react-dialog

# Type check
npx tsc --noEmit src/components/output-project/CreateProjectModal.tsx 2>&1 | head -20 || echo "Type check done"

# Verify exports
cat src/components/output-project/index.ts
```
  </verify>
  <done>
- CreateProjectModal.tsx exists with full flow
- Uses useStacksGrouped and useCreateOutputProject hooks
- Validates name and stack before enabling Create
- index.ts exports all three components
  </done>
</task>

</tasks>

<verification>
```bash
cd /Users/gilberto/projetos/wxk/wxcode/frontend

# 1. Verify all files exist
ls -la src/components/output-project/

# 2. Type check all components
npx tsc --noEmit src/components/output-project/*.tsx 2>&1 | tail -10

# 3. Verify exports work
node -e "
const fs = require('fs');
const content = fs.readFileSync('src/components/output-project/index.ts', 'utf8');
console.log('Exports:', content.match(/export.*from/g)?.length || 0, 'components');
"

# 4. Check component sizes (should be substantial)
wc -l src/components/output-project/*.tsx

# 5. Lint check
npx eslint src/components/output-project/*.tsx --quiet 2>&1 | tail -10 || echo "Lint done"
```
</verification>

<success_criteria>
- StackSelector renders stacks in 3 groups with radio selection
- ConfigurationSelector renders dropdown with None option
- CreateProjectModal combines both with name input and create action
- All components have proper TypeScript types
- Modal calls useCreateOutputProject on submit
- No TypeScript or ESLint errors
</success_criteria>

<output>
After completion, create `.planning/phases/16-output-project-ui/16-03-SUMMARY.md`
</output>
