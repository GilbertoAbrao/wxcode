---
phase: 18-milestone-ui
plan: 02
type: execute
wave: 2
depends_on: ["18-01"]
files_modified:
  - frontend/src/types/milestone.ts
  - frontend/src/hooks/useMilestones.ts
  - frontend/src/components/milestone/MilestoneCard.tsx
  - frontend/src/components/milestone/MilestoneList.tsx
  - frontend/src/components/milestone/index.ts
autonomous: true

must_haves:
  truths:
    - "Hook fetches milestones for output project"
    - "Hook creates new milestone"
    - "MilestoneCard shows status with appropriate styling"
    - "MilestoneList renders list of milestones"
  artifacts:
    - path: "frontend/src/types/milestone.ts"
      provides: "TypeScript types for Milestone"
      exports: ["Milestone", "MilestoneStatus"]
    - path: "frontend/src/hooks/useMilestones.ts"
      provides: "TanStack Query hooks"
      exports: ["useMilestones", "useCreateMilestone"]
    - path: "frontend/src/components/milestone/MilestoneCard.tsx"
      provides: "Individual milestone display"
      exports: ["MilestoneCard"]
    - path: "frontend/src/components/milestone/MilestoneList.tsx"
      provides: "List of milestones"
      exports: ["MilestoneList"]
  key_links:
    - from: "frontend/src/hooks/useMilestones.ts"
      to: "/api/milestones"
      via: "fetch calls"
      pattern: "fetch.*api/milestones"
    - from: "frontend/src/components/milestone/MilestoneList.tsx"
      to: "useMilestones hook"
      via: "import and call"
      pattern: "useMilestones"
---

<objective>
Frontend hooks and basic milestone components

Purpose: Provide React hooks for milestone data fetching and basic UI components to display milestones.

Output:
- TypeScript types for Milestone
- useMilestones hook for fetching
- useCreateMilestone hook for creating
- MilestoneCard component with status display
- MilestoneList component for rendering list
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/STATE.md
@.planning/phases/18-milestone-ui/18-RESEARCH.md
@.planning/phases/18-milestone-ui/18-01-SUMMARY.md

# Pattern references
@frontend/src/hooks/useOutputProjects.ts
@frontend/src/components/output-project/InitializeButton.tsx
@frontend/src/types/output-project.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Milestone types and useMilestones hook</name>
  <files>frontend/src/types/milestone.ts, frontend/src/hooks/useMilestones.ts</files>
  <action>
Create TypeScript types in frontend/src/types/milestone.ts:

```typescript
export type MilestoneStatus = "pending" | "in_progress" | "completed" | "failed";

export interface Milestone {
  id: string;
  output_project_id: string;
  element_id: string;
  element_name: string;
  status: MilestoneStatus;
  created_at: string;
  completed_at?: string;
}

export interface MilestoneListResponse {
  milestones: Milestone[];
  total: number;
}

export interface CreateMilestoneRequest {
  output_project_id: string;
  element_id: string;
}
```

Create hooks in frontend/src/hooks/useMilestones.ts:

1. `useMilestones(outputProjectId: string)` - TanStack Query hook
   - queryKey: ["milestones", outputProjectId]
   - Fetches GET /api/milestones?output_project_id={id}
   - enabled: !!outputProjectId

2. `useCreateMilestone()` - TanStack Mutation hook
   - POST /api/milestones with body { output_project_id, element_id }
   - onSuccess: invalidate ["milestones", variables.output_project_id]

Follow the exact patterns from useOutputProjects.ts for fetch functions and error handling.
  </action>
  <verify>
cd /Users/gilberto/projetos/wxk/wxcode/frontend && npx tsc --noEmit src/hooks/useMilestones.ts 2>&1 | head -5 || echo "TypeScript check complete"
  </verify>
  <done>Milestone types and hooks created with proper TanStack Query patterns</done>
</task>

<task type="auto">
  <name>Task 2: Create MilestoneCard component</name>
  <files>frontend/src/components/milestone/MilestoneCard.tsx</files>
  <action>
Create MilestoneCard component that displays a single milestone with status-appropriate styling.

Component should:
1. Accept props: milestone: Milestone, onInitialize: () => void, isInitializing: boolean
2. Show status icon based on milestone.status:
   - pending: Clock icon (text-zinc-400, bg-zinc-800)
   - in_progress: Loader2 icon with animate-spin (text-blue-400, bg-blue-500/10)
   - completed: CheckCircle icon (text-green-400, bg-green-500/10)
   - failed: AlertCircle icon (text-red-400, bg-red-500/10)
3. Show element_name as title
4. Show created_at as "Created {date}"
5. Show "Initialize" button only when status is "pending"
6. Button should be disabled when isInitializing is true

Use STATUS_CONFIG pattern from research for icon/color mapping.

Import icons from lucide-react: Clock, Loader2, CheckCircle, AlertCircle, Play
Import Button from @/components/ui/button
Import cn from @/lib/utils

Style the card with:
- p-4 rounded-lg border
- Dynamic bg based on status
- Flex layout with items-center justify-between
  </action>
  <verify>
cd /Users/gilberto/projetos/wxk/wxcode/frontend && npx tsc --noEmit src/components/milestone/MilestoneCard.tsx 2>&1 | head -5 || echo "TypeScript check complete"
  </verify>
  <done>MilestoneCard component with status-based styling and initialize button</done>
</task>

<task type="auto">
  <name>Task 3: Create MilestoneList component and exports</name>
  <files>frontend/src/components/milestone/MilestoneList.tsx, frontend/src/components/milestone/index.ts</files>
  <action>
Create MilestoneList component that renders a list of milestones.

Props:
```typescript
interface MilestoneListProps {
  milestones: Milestone[];
  onInitialize: (milestoneId: string) => void;
  initializingId: string | null;  // ID of currently initializing milestone
  emptyMessage?: string;
}
```

Component should:
1. Show empty state with emptyMessage when milestones.length === 0
2. Render MilestoneCard for each milestone in a space-y-3 layout
3. Pass isInitializing={initializingId === milestone.id} to each card
4. Handle onInitialize by calling prop with milestone.id

Empty state: Show a centered message with text-zinc-400

Create index.ts to export:
```typescript
export { MilestoneCard } from "./MilestoneCard";
export { MilestoneList } from "./MilestoneList";
```

Create the milestone directory if it doesn't exist.
  </action>
  <verify>
cd /Users/gilberto/projetos/wxk/wxcode/frontend && npx tsc --noEmit src/components/milestone/index.ts 2>&1 | head -5 || echo "TypeScript check complete"
  </verify>
  <done>MilestoneList component and exports created</done>
</task>

</tasks>

<verification>
1. Run TypeScript check: `cd frontend && npx tsc --noEmit`
2. Verify imports work:
   ```typescript
   import { useMilestones, useCreateMilestone } from "@/hooks/useMilestones";
   import { MilestoneCard, MilestoneList } from "@/components/milestone";
   ```
3. Check no ESLint errors: `cd frontend && npm run lint -- --max-warnings=0 src/components/milestone src/hooks/useMilestones.ts`
</verification>

<success_criteria>
- TypeScript compiles without errors
- useMilestones hook returns query with milestones data
- useCreateMilestone hook returns mutation
- MilestoneCard displays all status variants correctly
- MilestoneList renders list of cards
- Components follow existing patterns (Radix, cn utility, Lucide icons)
</success_criteria>

<output>
After completion, create `.planning/phases/18-milestone-ui/18-02-SUMMARY.md`
</output>
